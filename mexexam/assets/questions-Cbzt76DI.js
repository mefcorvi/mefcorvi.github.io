import{v as m,J as q,x as S,K as $,G as c}from"./index-BwivWZ5K.js";const I=m(()=>{const o=new Map,n=(e,i,p)=>{i&&p&&o.set(`$${e}$${i}`,p)},d=(e,i)=>i?o.get(`$${e}$${i}`)??i:"";return n("es","I don't know","No sé"),n("ru","I don't know","Не знаю"),{add:n,t:d}});var w=(o=>(o.Idle="idle",o.Loading="loading",o.Loaded="loaded",o.Error="error",o))(w||{});function y(o,n){return async()=>{o().loadingStatus="loading";try{await n(),o().loadingStatus="loaded"}catch{o().loadingStatus="error"}}}const M=m(()=>{const o=q(new Map),n=q(new Map),d=S(!1),e=I(),i=async()=>{if(n.size>0)return;const u=await $();for(const s of u){const l={id:s.id,title:s.title,questions:[],image:s.image,loadingStatus:w.Idle,load:y(()=>l,async()=>{var f;if(l.loadingStatus===w.Loaded)return;const h=await s.questions();for(const t of h){const r={id:t.id,section:l,answer:t.answer,question:t.question,note:t.note,noteImage:"noteImage"in t?t.noteImage:void 0,options:(f=t.options)==null?void 0:f.map((a,v)=>c({id:v,value:a,isAnswer:!1})),type:t.type==="text"?"text":"choice"};if(t.ru&&(e.add("ru",t.answer,t.ru.answer),e.add("ru",t.question,t.ru.question),e.add("ru",t.note,t.ru.note),t.ru.options&&t.options))for(let a=0;a<t.ru.options.length;a++)e.add("ru",t.options[a],t.ru.options[a]);if(t.en&&(e.add("en",t.answer,t.en.answer),e.add("en",t.question,t.en.question),e.add("en",t.note,t.en.note),t.en.options&&t.options))for(let a=0;a<t.en.options.length;a++)e.add("en",t.options[a],t.en.options[a]);r.type==="choice"&&r.options&&r.options.push(c({id:r.options.length,isAnswer:!0,value:r.answer}));const g=c(r);o.set(r.id,g),l.questions.push(g)}})};n.set(l.id,c(l)),e.add("ru",s.title,s.ru.title),e.add("en",s.title,s.en.title),d.value=!0}};return{loadAll:async()=>{await i(),await Promise.all([...n.values()].map(u=>u.load()))},loadSection:async u=>{await i();const s=n.get(u);s&&await s.load()},loadSections:i,reset:()=>{d.value=!1,n.clear(),o.clear()},isLoaded:d,questions:o,sections:n}});export{I as a,M as u};
