import{l as I}from"./index-qzVYvbF6.js";import{c as q}from"./utils-BRnDto5j.js";import{W as m,a as S,V as c}from"./vendor-mc0iK3xg.js";const $=q(()=>{const n=new Map,a=(o,i,p)=>{i&&p&&n.set(`$${o}$${i}`,p)},d=(o,i)=>i?n.get(`$${o}$${i}`)??i:"";return a("es","I don't know","No sé"),a("ru","I don't know","Не знаю"),a("zh","I don't know","我不知道"),{add:a,t:d}});var f=(n=>(n.Idle="idle",n.Loading="loading",n.Loaded="loaded",n.Error="error",n))(f||{});function v(n,a){return async()=>{n().loadingStatus="loading";try{await a(),n().loadingStatus="loaded"}catch{n().loadingStatus="error"}}}const L=q(()=>{const n=m(new Map),a=m(new Map),d=S(!1),o=$(),i=async()=>{if(a.size>0)return;const u=await I();for(const s of u){const l={id:s.id,title:s.title,questions:[],image:s.image,loadingStatus:f.Idle,load:v(()=>l,async()=>{var w;if(l.loadingStatus===f.Loaded)return;const g=await s.questions();for(const t of g){const r={id:t.id,section:l,answer:t.answer,question:t.question,note:t.note,noteImage:"noteImage"in t?t.noteImage:void 0,options:(w=t.options)==null?void 0:w.map((e,z)=>c({id:z,value:e,isAnswer:!1})),type:t.type==="text"?"text":"choice"};if(t.ru&&(o.add("ru",t.answer,t.ru.answer),o.add("ru",t.question,t.ru.question),o.add("ru",t.note,t.ru.note),t.ru.options&&t.options))for(let e=0;e<t.ru.options.length;e++)o.add("ru",t.options[e],t.ru.options[e]);if(t.en&&(o.add("en",t.answer,t.en.answer),o.add("en",t.question,t.en.question),o.add("en",t.note,t.en.note),t.en.options&&t.options))for(let e=0;e<t.en.options.length;e++)o.add("en",t.options[e],t.en.options[e]);if(t.zh&&(o.add("zh",t.answer,t.zh.answer),o.add("zh",t.question,t.zh.question),o.add("zh",t.note,t.zh.note),t.zh.options&&t.options))for(let e=0;e<t.zh.options.length;e++)o.add("zh",t.options[e],t.zh.options[e]);r.type==="choice"&&r.options&&r.options.push(c({id:r.options.length,isAnswer:!0,value:r.answer}));const h=c(r);n.set(r.id,h),l.questions.push(h)}})};a.set(l.id,c(l)),o.add("ru",s.title,s.ru.title),o.add("en",s.title,s.en.title),o.add("zh",s.title,s.zh.title),d.value=!0}};return{loadAll:async()=>{await i(),await Promise.all([...a.values()].map(u=>u.load()))},loadSection:async u=>{await i();const s=a.get(u);s&&await s.load()},loadSections:i,reset:()=>{d.value=!1,n.clear()},isLoaded:d,questions:n,sections:a}});export{$ as a,L as u};
