import{a as h,k as y,q as oe,P as ae,Q as le,S as ie,v as re,y as b,p as ce,m as ue,x as m,E as s,u as t,D as v,H as l,F as R,I as de,L as D,M as G,N as ee,O as se}from"./vendor-mc0iK3xg.js";import{u as me,G as ve,_ as _e}from"./localization-BT8080HU.js";import{G as te}from"./GeneralButton-BJ0peaa-.js";import{u as he}from"./questions-C--eHzCh.js";import{c as fe}from"./utils-BRnDto5j.js";import{R as pe}from"./index-qzVYvbF6.js";const ge=10,$=ge*60*1e3,we=fe(()=>{const{questions:ne,loadAll:q,loadSection:L,reset:c}=he(),r=h([]),x=h(new Map),u=h(new Map),A=h(!1),f=h(!1),S=h(null),E=h(null),p=h($),g=h(null),O=y(()=>{const o=[];for(const e of ne.values())e.type==="choice"&&o.push(e);return o}),k=(o=10)=>{const e=[...O.value],n=[];for(let i=0;i<Math.min(o,e.length);i++){const d=Math.floor(Math.random()*e.length);n.push(e[d]),e.splice(d,1)}return n},V=o=>{const e=[...o];for(let n=e.length-1;n>0;n--){const i=Math.floor(Math.random()*(n+1));[e[n],e[i]]=[e[i],e[n]]}return e},N=()=>{E.value=Date.now(),p.value=$,g.value=window.setInterval(()=>{if(E.value){const o=Date.now()-E.value;p.value=Math.max(0,$-o),p.value<=0&&(Q(),U())}},1e3)},Q=()=>{g.value&&(clearInterval(g.value),g.value=null)},H=o=>{const e=Math.ceil(o/1e3),n=Math.floor(e/60),i=e%60;return`${n.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`},B=async o=>{o?await L(o):await q(),r.value=k(10),x.value.clear();for(const e of r.value)e.options&&x.value.set(e.id,V(e.options));u.value.clear(),A.value=!0,f.value=!1,S.value=null,N()},T=(o,e)=>{f.value||u.value.set(o,e)},I=o=>u.value.get(o)??null,U=()=>{var i;if(f.value)return;Q();const o=[];let e=0,n=0;for(const d of r.value){const C=u.value.get(d.id),w=(i=d.options)==null?void 0:i.find(M=>M.id===C),a=(w==null?void 0:w.isAnswer)??!1;o.push({questionId:d.id,selectedOptionId:C??null,isCorrect:a}),a?e++:n++}S.value={correctAnswers:e,wrongAnswers:n,totalQuestions:r.value.length,percentage:Math.round(e/r.value.length*100),answers:o},f.value=!0},P=()=>{Q(),r.value=[],x.value.clear(),u.value.clear(),A.value=!1,f.value=!1,S.value=null,E.value=null,p.value=$,c()},X=o=>x.value.get(o.id)??[],j=o=>r.value.find(e=>e.id===o),W=o=>{var e;return(e=S.value)==null?void 0:e.answers.find(n=>n.questionId===o)},J=y(()=>r.value.length>0&&u.value.size===r.value.length),z=y(()=>u.value.size),F=y(()=>H(p.value)),K=y(()=>p.value<=3e4);return{examQuestions:r,userAnswers:u,isExamStarted:A,isExamFinished:f,examResults:S,timeRemaining:p,formattedTimeRemaining:F,isTimeRunningOut:K,startExam:B,selectAnswer:T,getSelectedAnswer:I,finishExam:U,resetExam:P,getRandomizedOptions:X,getQuestionById:j,getAnswerById:W,isAllQuestionsAnswered:J,answeredQuestionsCount:z,stopTimer:Q}}),xe={class:"exam-header"},Ae=["title"],Ee={key:0,class:"loading"},Ce={key:1,class:"exam-content"},Se={class:"questions-list"},Qe={class:"question-header"},ke={class:"question-number"},Re={class:"question-text"},ye={class:"options-list"},Te=["name","value","checked","onChange","disabled"],Ie={class:"option-text"},Me={class:"finish-section"},be={key:2,class:"results-content"},Oe={class:"results-header"},Ne={class:"results-summary"},Be={class:"result-item correct"},Ue={class:"result-label"},ze={class:"result-value"},Fe={class:"result-item wrong"},De={class:"result-label"},Ge={class:"result-value"},$e={class:"result-item total"},qe={class:"result-label"},Le={class:"result-value"},Ve={class:"result-item percentage"},He={class:"result-label"},Pe={class:"result-value"},Xe={class:"results-questions"},je={class:"question-header"},We={class:"question-number"},Je={class:"question-text"},Ke={class:"options-list"},Ye={class:"option-text"},Ze={class:"actions"},es=oe({__name:"ExamPage",setup(ne){const q=ce(),L=ue(),{t:c}=me(),{examQuestions:r,isExamStarted:x,isExamFinished:u,examResults:A,startExam:f,selectAnswer:S,getSelectedAnswer:E,finishExam:p,resetExam:g,getRandomizedOptions:O,getAnswerById:k,formattedTimeRemaining:V,isTimeRunningOut:N,isAllQuestionsAnswered:Q,stopTimer:H}=we(),B=y(()=>L.params.sectionId),T=h(new Map),I=h(!1);ae((e,n,i)=>{g(),i()}),le(()=>{x.value&&g(),f(B.value).catch(console.error)}),ie(()=>{H()});const U=(e,n)=>{S(e,n),I.value=!1},P=()=>{for(const e of r.value)if(E(e.id)===null)return e.id;return null},X=e=>{const n=T.value.get(e);n&&n.scrollIntoView({behavior:"smooth",block:"center"})},j=()=>{if(Q.value)p(),window.scrollTo(0,0);else{I.value=!0;const e=P();e&&X(e)}},W=async()=>{g(),window.scrollTo(0,0),await f(B.value)},J=()=>{g(),q.push({name:pe.Home})},z=e=>{if(!u.value)return"";const n=k(e);return n?n.isCorrect?"correct":"wrong":""},F=(e,n)=>{var w;if(!u.value)return"";const i=k(e);if(!i)return"";const d=r.value.find(a=>a.id===e),C=(w=d==null?void 0:d.options)==null?void 0:w.find(a=>a.id===n);return C?C.isAnswer?"correct-answer":i.selectedOptionId===n&&!i.isCorrect?"wrong-answer":"":""},K=(e,n)=>{n?T.value.set(e,n):T.value.delete(e)},o=e=>E(e)===null;return(e,n)=>(m(),re(ve,null,{topBar:b(()=>[s("div",xe,[t(x)&&!t(u)?(m(),v("div",{key:0,class:R(["timer",{"time-running-out":t(N)}]),title:t(N)?t(c)("Time is running out!"):t(c)("Time remaining")},l(t(V)),11,Ae)):de("",!0)])]),default:b(()=>{var i,d,C,w;return[t(x)?t(u)?(m(),v("div",be,[s("div",Oe,[s("h2",null,l(t(c)("Exam Results")),1),s("div",Ne,[s("div",Be,[s("span",Ue,l(t(c)("Correct")),1),s("span",ze,l((i=t(A))==null?void 0:i.correctAnswers),1)]),s("div",Fe,[s("span",De,l(t(c)("Wrong")),1),s("span",Ge,l((d=t(A))==null?void 0:d.wrongAnswers),1)]),s("div",$e,[s("span",qe,l(t(c)("Total")),1),s("span",Le,l((C=t(A))==null?void 0:C.totalQuestions),1)]),s("div",Ve,[s("span",He,l(t(c)("Score")),1),s("span",Pe,l((w=t(A))==null?void 0:w.percentage)+"%",1)])])]),s("div",Xe,[(m(!0),v(D,null,G(t(r),(a,M)=>{var _,Y;return m(),v("div",{key:a.id,class:R(["result-question",z(a.id)])},[s("div",je,[s("span",We,l(M+1)+".",1),s("span",Je,l(a.question),1),s("span",{class:R(["result-indicator",(_=t(k)(a.id))!=null&&_.isCorrect?"correct":"wrong"])},l((Y=t(k)(a.id))!=null&&Y.isCorrect?"✓":"✗"),3)]),s("div",Ke,[(m(!0),v(D,null,G(t(O)(a),Z=>(m(),v("div",{key:Z.id,class:R(["option-item",F(a.id,Z.id)])},[s("span",Ye,l(Z.value),1)],2))),128))])],2)}),128))]),s("div",Ze,[ee(te,{onClick:W,class:"new-exam-button"},{default:b(()=>[se(l(t(c)("Start New Exam")),1)]),_:1}),ee(te,{onClick:J,class:"home-button"},{default:b(()=>[se(l(t(c)("Go Home")),1)]),_:1})])])):(m(),v("div",Ce,[s("div",Se,[(m(!0),v(D,null,G(t(r),(a,M)=>(m(),v("div",{key:a.id,class:R(["question-item",z(a.id),{"unanswered-highlight":I.value&&o(a.id)}]),ref_for:!0,ref:_=>K(a.id,_)},[s("div",Qe,[s("span",ke,l(M+1)+".",1),s("span",Re,l(a.question),1)]),s("div",ye,[(m(!0),v(D,null,G(t(O)(a),_=>(m(),v("label",{key:_.id,class:R(["option-item",F(a.id,_.id)])},[s("input",{type:"radio",name:`question-${a.id}`,value:_.id,checked:t(E)(a.id)===_.id,onChange:Y=>U(a.id,_.id),disabled:t(u)},null,40,Te),s("span",Ie,l(_.value),1)],2))),128))])],2))),128))]),s("div",Me,[ee(te,{onClick:j,class:"finish-button"},{default:b(()=>[se(l(t(Q)?t(c)("Finish Exam"):t(c)("Check Unanswered Questions")),1)]),_:1})])])):(m(),v("div",Ee,l(t(c)("Loading exam...")),1))]}),_:1}))}}),is=_e(es,[["__scopeId","data-v-341e3e77"]]);export{is as default};
