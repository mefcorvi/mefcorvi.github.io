import{v as X,x as A,m as z,d as Y,y as Z,i as ss,j as b,q as es,p as ts,o as c,a as e,b as o,c as _,t as n,f as ns,F as I,r as M,k as W,s as J,R as as,n as k}from"./index-D4hfDQEj.js";import{u as os,G as ls,_ as rs}from"./localization-C-adBSIF.js";import{G as K}from"./GeneralButton-u7d60ZM2.js";import{u as is,a as cs}from"./questions-BiuSgwHY.js";const us=X(()=>{const{questions:U,loadAll:N,loadSection:O}=is(),u=A([]),C=A(new Map),i=A(new Map),w=A(!1),d=A(!1),m=A(null),Q=z(()=>{const t=[];for(const s of U.values())s.type==="choice"&&t.push(s);return t}),F=(t=10)=>{const s=[...Q.value],l=[];for(let h=0;h<Math.min(t,s.length);h++){const r=Math.floor(Math.random()*s.length);l.push(s[r]),s.splice(r,1)}return l},G=t=>{const s=[...t];for(let l=s.length-1;l>0;l--){const h=Math.floor(Math.random()*(l+1));[s[l],s[h]]=[s[h],s[l]]}return s},q=async t=>{t?await O(t):await N(),u.value=F(10),C.value.clear();for(const s of u.value)s.options&&C.value.set(s.id,G(s.options));i.value.clear(),w.value=!0,d.value=!1,m.value=null},S=(t,s)=>{d.value||i.value.set(t,s)},R=t=>i.value.get(t)??null,y=()=>{var h;if(d.value)return;const t=[];let s=0,l=0;for(const r of u.value){const v=i.value.get(r.id),f=(h=r.options)==null?void 0:h.find(x=>x.id===v),p=(f==null?void 0:f.isAnswer)??!1;t.push({questionId:r.id,selectedOptionId:v??null,isCorrect:p}),p?s++:l++}m.value={correctAnswers:s,wrongAnswers:l,totalQuestions:u.value.length,percentage:Math.round(s/u.value.length*100),answers:t},d.value=!0},T=()=>{u.value=[],C.value.clear(),i.value.clear(),w.value=!1,d.value=!1,m.value=null},V=t=>C.value.get(t.id)??[],B=t=>u.value.find(s=>s.id===t),$=t=>{var s;return(s=m.value)==null?void 0:s.answers.find(l=>l.questionId===t)},H=z(()=>u.value.length>0&&i.value.size===u.value.length),L=z(()=>i.value.size);return{examQuestions:u,userAnswers:i,isExamStarted:w,isExamFinished:d,examResults:m,startExam:q,selectAnswer:S,getSelectedAnswer:R,finishExam:y,resetExam:T,getRandomizedOptions:V,getQuestionById:B,getAnswerById:$,isAllQuestionsAnswered:H,answeredQuestionsCount:L}}),ds={class:"exam-header"},_s={key:0,class:"progress"},hs={key:0,class:"loading"},vs={key:1,class:"exam-content"},ms={class:"questions-list"},fs={class:"question-header"},ps={class:"question-number"},gs={class:"question-text"},ws={class:"options-list"},xs=["name","value","checked","onChange","disabled"],Cs={class:"option-text"},ys={class:"finish-section"},As={key:2,class:"results-content"},Es={class:"results-header"},bs={class:"results-summary"},ks={class:"result-item correct"},Qs={class:"result-label"},Ss={class:"result-value"},Rs={class:"result-item wrong"},Bs={class:"result-label"},Is={class:"result-value"},Ms={class:"result-item total"},zs={class:"result-label"},Ns={class:"result-value"},Os={class:"result-item percentage"},Fs={class:"result-label"},Gs={class:"result-value"},qs={class:"results-questions"},Ts={class:"question-header"},Vs={class:"question-number"},$s={class:"question-text"},Hs={class:"options-list"},Ls={class:"option-text"},Ps={class:"actions"},js=Y({__name:"ExamPage",setup(U){const N=es(),O=ts(),u=cs(),{locale:C}=os(),{examQuestions:i,isExamStarted:w,isExamFinished:d,examResults:m,startExam:Q,selectAnswer:F,getSelectedAnswer:G,finishExam:q,resetExam:S,getRandomizedOptions:R,getAnswerById:y,isAllQuestionsAnswered:T,answeredQuestionsCount:V}=us(),B=z(()=>O.params.sectionId);Z(async()=>{w.value||await Q(B.value)});const $=(r,v)=>{F(r,v)},H=()=>{q(),window.scrollTo(0,0)},L=async()=>{S(),await Q(B.value)},t=()=>{S(),N.push({name:as.Home})},s=r=>u.t(C.value,r),l=r=>{if(!d.value)return"";const v=y(r);return v?v.isCorrect?"correct":"wrong":""},h=(r,v)=>{var E;if(!d.value)return"";const f=y(r);if(!f)return"";const p=i.value.find(a=>a.id===r),x=(E=p==null?void 0:p.options)==null?void 0:E.find(a=>a.id===v);return x?x.isAnswer?"correct-answer":f.selectedOptionId===v&&!f.isCorrect?"wrong-answer":"":""};return(r,v)=>(c(),ss(ls,null,{topBar:b(()=>[e("div",ds,[o(w)&&!o(d)?(c(),_("div",_s,n(o(V))+"/"+n(o(i).length),1)):ns("",!0)])]),default:b(()=>{var f,p,x,E;return[o(w)?o(d)?(c(),_("div",As,[e("div",Es,[e("h2",null,n(s("Exam Results")),1),e("div",bs,[e("div",ks,[e("span",Qs,n(s("Correct")),1),e("span",Ss,n((f=o(m))==null?void 0:f.correctAnswers),1)]),e("div",Rs,[e("span",Bs,n(s("Wrong")),1),e("span",Is,n((p=o(m))==null?void 0:p.wrongAnswers),1)]),e("div",Ms,[e("span",zs,n(s("Total")),1),e("span",Ns,n((x=o(m))==null?void 0:x.totalQuestions),1)]),e("div",Os,[e("span",Fs,n(s("Score")),1),e("span",Gs,n((E=o(m))==null?void 0:E.percentage)+"%",1)])])]),e("div",qs,[(c(!0),_(I,null,M(o(i),(a,P)=>{var g,j;return c(),_("div",{key:a.id,class:k(["result-question",l(a.id)])},[e("div",Ts,[e("span",Vs,n(P+1)+".",1),e("span",$s,n(s(a.question)),1),e("span",{class:k(["result-indicator",(g=o(y)(a.id))!=null&&g.isCorrect?"correct":"wrong"])},n((j=o(y)(a.id))!=null&&j.isCorrect?"✓":"✗"),3)]),e("div",Hs,[(c(!0),_(I,null,M(o(R)(a),D=>(c(),_("div",{key:D.id,class:k(["option-item",h(a.id,D.id)])},[e("span",Ls,n(s(D.value)),1)],2))),128))])],2)}),128))]),e("div",Ps,[W(K,{onClick:L,class:"new-exam-button"},{default:b(()=>[J(n(s("Start New Exam")),1)]),_:1}),W(K,{onClick:t,class:"home-button"},{default:b(()=>[J(n(s("Go Home")),1)]),_:1})])])):(c(),_("div",vs,[e("div",ms,[(c(!0),_(I,null,M(o(i),(a,P)=>(c(),_("div",{key:a.id,class:k(["question-item",l(a.id)])},[e("div",fs,[e("span",ps,n(P+1)+".",1),e("span",gs,n(s(a.question)),1)]),e("div",ws,[(c(!0),_(I,null,M(o(R)(a),g=>(c(),_("label",{key:g.id,class:k(["option-item",h(a.id,g.id)])},[e("input",{type:"radio",name:`question-${a.id}`,value:g.id,checked:o(G)(a.id)===g.id,onChange:j=>$(a.id,g.id),disabled:o(d)},null,40,xs),e("span",Cs,n(s(g.value)),1)],2))),128))])],2))),128))]),e("div",ys,[W(K,{onClick:H,disabled:!o(T),class:"finish-button"},{default:b(()=>[J(n(s("Finish Exam")),1)]),_:1},8,["disabled"])])])):(c(),_("div",hs,n(s("Loading exam...")),1))]}),_:1}))}}),Us=rs(js,[["__scopeId","data-v-7243fa68"]]);export{Us as default};
