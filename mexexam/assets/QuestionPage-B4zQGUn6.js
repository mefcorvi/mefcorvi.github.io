const __vite__fileDeps=["assets/interfaces-XM_yqSOt.js","assets/GeneralPage-BZc4L2FZ.js","assets/index-CCEbdL00.js","assets/index-CTegagKC.css","assets/GeneralPage-so3pQUpV.css","assets/interfaces-CnjOi9ha.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{_ as f,q as me,s as k,v as M,x as $,y as U,z as ge,A as ke,a as ae,B as ye,C as Z,D as ie,E as Ae,d as qe,c as Ce,w as H,n as v,k as s,F as Oe,o as q,b as p,m as E,t as x,f as ee,l as te,h as O,G as se,H as ne,i as I,e as Ee,I as be}from"./index-CCEbdL00.js";import{G as Pe,a as Ie}from"./GeneralPage-BZc4L2FZ.js";import{G as Re}from"./interfaces-XM_yqSOt.js";const oe=Object.assign({"./questions/art-lit-music.ts":()=>f(()=>import("./art-lit-music-BQYj3k_y.js"),[]),"./questions/art-paint-cinema.ts":()=>f(()=>import("./art-paint-cinema-f8o43M2_.js"),[]),"./questions/citizenship.ts":()=>f(()=>import("./citizenship--pcrkfin.js"),[]),"./questions/gastronomy.ts":()=>f(()=>import("./gastronomy-XnkjYgvu.js"),[]),"./questions/geografy.ts":()=>f(()=>import("./geografy-Djk_r5Cr.js"),[]),"./questions/history-colony.ts":()=>f(()=>import("./history-colony-CEsKSQc0.js"),[]),"./questions/history-independency.ts":()=>f(()=>import("./history-independency-BRIqbiq0.js"),[]),"./questions/history-modern.ts":()=>f(()=>import("./history-modern-C7q8OpuJ.js"),[]),"./questions/history-prespain.ts":()=>f(()=>import("./history-prespain-CDlcUevk.js"),[]),"./questions/history-revoluction.ts":()=>f(()=>import("./history-revoluction-DnDAoPUh.js"),[]),"./questions/interfaces.ts":()=>f(()=>import("./interfaces-XM_yqSOt.js").then(o=>o.i),__vite__mapDeps([0,1,2,3,4,5])),"./questions/science.ts":()=>f(()=>import("./science-Dk57vpCz.js"),[]),"./questions/traditions-culture.ts":()=>f(()=>import("./traditions-culture-C6eoM_xj.js"),[])}),Te=async()=>{const o={sections:[]};for(const t in oe){const u=await oe[t]();u&&typeof u=="object"&&"data"in u&&o.sections.push(u.data)}return console.dir(o),o},Qe=me(()=>{const{questions:o,translations:t,load:u}=De(),d=re("correct-questions"),r=re("wrong-questions"),c=k(),m=M({id:-1,value:"No se",isAnswer:!1});t.add("ru","No se","Не знаю");const w=()=>{let a=c.value;for(;a===c.value;)if(a=ze(o,d.value,r.value),!a)return a;return a},e=$(()=>{if(!c.value)return null;const a=o.get(c.value);if(!a)throw new Error(`Failed to get question by id ${c.value}`);return a}),_=k([]),C=()=>{var a;_.value=[...(((a=e.value)==null?void 0:a.options)??[]).sort(()=>Math.random()-.5),m]},l=k(),y=k(!1),A=a=>{c.value=a},g=a=>o.has(a),b=k(0),P=k(0),R=()=>{b.value=0,P.value=0},F=a=>{if(e.value&&e.value.type==="choice"){if(!_.value.includes(a))throw new Error("Current question does not have the selected option");l.value=a}},G=()=>{l.value&&e.value&&(l.value.isAnswer?(b.value++,d.value.add(e.value.id),r.value.delete(e.value.id)):(P.value++,r.value.add(e.value.id),d.value.delete(e.value.id)))},T=()=>{e.value&&e.value.type==="text"&&(y.value=!0)};U(()=>{var a;return(a=e.value)==null?void 0:a.id},()=>{l.value=void 0,y.value=!1,C()},{immediate:!0,flush:"sync"});const L=$(()=>({correctQuestions:d.value.size,wrongQuestions:r.value.size,unansweredQuestions:o.size-d.value.size-r.value.size,totalQuestions:o.size,correctPercentage:d.value.size/o.size*100,wrongPercentage:r.value.size/o.size*100,unansweredPercentage:(o.size-d.value.size-r.value.size)/o.size*100}));return{load:u,stat:L,correctCount:b,correctQuestions:d,wrongQuestions:r,currentOptionsRandomized:_,currentQuestion:e,isAnswerRevealed:y,selectedAnswer:l,translations:t,wrongCount:P,getRandomQuestionId:w,resetCount:R,updateCounters:G,revealAnswer:T,selectAnswer:F,setQuestion:A,hasQuestion:g}});function re(o){return ge(o,()=>new Set,void 0,{serializer:{read(t){return t?new Set(t.split(",")):new Set},write(t){return[...t].join(",")}}})}function ze(o,t,u){if(Math.random()<u.size/10){const r=[...u];return r[Math.floor(Math.random()*r.length)]}if(Math.random()<.2){const r=[...t];return r[Math.floor(Math.random()*r.length)]}const d=[...o.keys()];return d[Math.floor(Math.random()*d.length)]}function De(){const o=new Map,t=new Map,u=xe();return{load:async()=>{var c;const r=await Te();for(const m of r.sections){const w={id:m.id,title:m.title,questions:[]};t.set(w.id,M(w)),u.add("ru",m.title,m.ru.title);for(const e of m.questions){const _={id:e.id,section:w,answer:e.answer,question:e.question,note:e.note,noteImage:"noteImage"in e?e.noteImage:void 0,options:(c=e.options)==null?void 0:c.map((l,y)=>M({id:y,value:l,isAnswer:!1})),type:e.type==="text"?"text":"choice"};if(u.add("ru",e.answer,e.ru.answer),u.add("ru",e.question,e.ru.question),u.add("ru",e.note,e.ru.note),e.ru.options&&e.options)for(let l=0;l<e.ru.options.length;l++)u.add("ru",e.options[l],e.ru.options[l]);_.type==="choice"&&_.options&&_.options.push(M({id:_.options.length,isAnswer:!0,value:_.answer}));const C=M(_);o.set(_.id,C),w.questions.push(C)}}},sections:t,questions:o,translations:u}}const xe=()=>{const o=new Map;return{add:(d,r,c)=>{r&&c&&o.set(`$${d}$${r}`,c)},t:(d,r)=>r?o.get(`$${d}$${r}`)??r:""}},K=new WeakMap;function Me(o,t,u={}){const{mode:d="replace",route:r=ke(),router:c=ae(),transform:m=l=>l}=u;K.has(c)||K.set(c,new Map);const w=K.get(c);let e=r.params[o];Ae(()=>{e=void 0});let _;const C=ye((l,y)=>(_=y,{get(){return l(),m(e!==void 0&&e!==""?e:Z(t))},set(A){e!==A&&(e=A===t||A===null?void 0:A,w.set(o,A===t||A===null?void 0:A),y(),ie(()=>{if(w.size===0)return;const g=Object.fromEntries(w.entries());w.clear();const{params:b,query:P,hash:R}=r;c[Z(d)]({params:{...b,...g},query:P,hash:R})}))}}));return U(()=>r.params[o],l=>{e=l,_()},{flush:"sync"}),C}const $e=["src"],Le=["innerHTML"],Ve=qe({__name:"QuestionPage",setup(o){const t=Oe(),u=ae(),{load:d,stat:r,isAnswerRevealed:c,correctCount:m,currentOptionsRandomized:w,currentQuestion:e,getRandomQuestionId:_,resetCount:C,revealAnswer:l,selectAnswer:y,updateCounters:A,selectedAnswer:g,setQuestion:b,hasQuestion:P,translations:R,wrongCount:F}=Qe(),G=$(()=>{var n;return((n=e.value)==null?void 0:n.note)!==void 0}),T=Me("id",""),L=k(!1),a=k(!1),W=$(()=>L.value),ue=$(()=>{var n;return a.value||g.value||((n=e.value)==null?void 0:n.type)==="text"}),Q=k(),z=k(!1),J=()=>{if(Q.value=void 0,z.value=!1,P(T.value)){b(T.value);const n=window.history.state["answer-id"],i=window.history.state["answer-revealed"]==="1";if(L.value=!!window.history.state.back,a.value=!!window.history.state.forward,typeof n=="number"){const h=w.value.find(S=>S.id===n);h&&y(h)}i&&l()}else u.replace({params:{id:_()}})};U(T,J),d().then(J);let X;const j=k(!1);let D;const ce=()=>{Q.value=void 0,window.clearTimeout(X),D=void 0,window.clearTimeout(D),j.value=!0,D=window.setTimeout(async()=>{var n;D=void 0,history.replaceState({"answer-id":(n=g.value)==null?void 0:n.id,"answer-revealed":c.value?"1":void 0},""),await u.push({params:{id:_()}}),await be(g).toBeUndefined(),await ie(),j.value=!1},parseInt(t.pageFadeOutDuration,10))},le=()=>{W.value&&window.history.back()},V=()=>{var n,i;if(!D){if(history.state.forward){history.forward();return}if(!(((n=e.value)==null?void 0:n.type)==="choice"&&!g.value)){if(((i=e.value)==null?void 0:i.type)==="text"&&!c.value){l();return}ce()}}},de=n=>{const i=[];return n.id===-1&&i.push(t.dontKnowOption),g.value?g.value.isAnswer?n===g.value?t.correct:(i.push(t["wrong-fade"]),i):n===Q.value?(i.push(t["correct-blinking"]),i):n.isAnswer?(i.push(t.correct),i):(i.push(t.wrong),i):i},_e=n=>{if(g.value){V();return}if(y(n),A(),!n.isAnswer){const i=w.value.find(h=>h.isAnswer);Q.value=i}X=window.setTimeout(()=>{Q.value=void 0},1e3)},B=k("es"),ve=n=>{Y(n)||V()},we=()=>{var n;(n=window.getSelection())!=null&&n.isCollapsed&&(B.value==="es"?B.value="ru":B.value="es")},N=n=>R.t(B.value,n),pe=n=>{Y(n)||(n.stopPropagation(),he())},he=()=>{z.value=!1},fe=()=>{z.value=!0};function Y(n){const i=n.target;return i.tagName==="BUTTON"||i.tagName==="A"}return(n,i)=>(q(),Ce(Pe,{onClick:ve,class:v({[s(t).fadeOut]:j.value})},{topBar:H(()=>[p("div",{class:v(s(t).navigation)},[p("div",{class:v([s(t).backBtn,{[s(t).disabled]:!W.value}]),onClick:E(le,["stop"])},"←",2),p("div",{class:v([s(t).noteBtn,{[s(t).disabled]:!G.value}]),onClick:E(fe,["stop"])},"?",2),p("div",{class:v([s(t).forwardBtn,{[s(t).disabled]:!ue.value}]),onClick:E(V,["stop"])},"→",2)],2),p("div",{class:v(s(t).counter),onClick:i[0]||(i[0]=E((...h)=>s(C)&&s(C)(...h),["stop"]))},[p("span",null,x(s(m)),1),ee(" / "),p("span",null,x(s(m)+s(F)),1)],2)]),default:H(()=>[p("div",{class:v(s(t).progress)},[p("div",{class:v(s(t).correctAnswers),style:te({width:`${s(r).correctPercentage}%`})},null,6),p("div",{class:v(s(t).wrongAnswers),style:te({width:`${s(r).wrongPercentage}%`})},null,6)],2),s(e)?(q(),O("div",{key:0,class:v(s(t).question)},[p("div",{class:v(s(t).text),onClick:E(we,["stop"])},[p("div",null,x(N(s(e).question)),1)],2),p("div",{class:v(s(t).answers)},[s(e).type==="choice"?(q(!0),O(se,{key:0},ne(s(w),h=>(q(),O("div",{key:`${s(e).id}-${h.id}`,class:v(s(t).option)},[Ee(Re,{onClick:E(S=>_e(h),["stop"]),class:v([s(t).button,de(h)])},{default:H(()=>[ee(x(N(h.value)),1)]),_:2},1032,["onClick","class"])],2))),128)):I("",!0),s(e).type==="text"?(q(),O("div",{key:1,class:v([s(t).answer,s(c)?"":s(t).hiddenAnswer]),onClick:E(V,["stop"])},[(q(!0),O(se,null,ne(N(s(e).answer).split(`
`),(h,S)=>(q(),O("p",{key:S},x(h),1))),128))],2)):I("",!0)],2)],2)):I("",!0),s(e)?(q(),O("div",{key:1,onClick:E(pe,["stop"]),class:v([s(t).noteContainer,{[s(t).hidden]:!z.value}])},[s(e).note?(q(),O("div",{key:0,class:v(["scroll",[s(t).note,{[s(t).hidden]:!z.value}]])},[s(e).noteImage?(q(),O("img",{key:0,src:`/notes/${s(e).noteImage}`},null,8,$e)):I("",!0),p("div",{innerHTML:N(s(e).note)},null,8,Le)],2)):I("",!0)],2)):I("",!0)]),_:1},8,["class"]))}}),Be="200ms",Ne="_counter_1nhk9_4",Se="_question_1nhk9_8",Fe="_text_1nhk9_15",Ge="_answers_1nhk9_40",je="_option_1nhk9_50",He="_fadeOut_1nhk9_54",Ke="_button_1nhk9_60",Ue="_correct_1nhk9_60",We="_success_1nhk9_1",Je="_wrong_1nhk9_67",Xe="_next_1nhk9_74",Ye="_answer_1nhk9_40",Ze="_hiddenAnswer_1nhk9_87",et="_navigation_1nhk9_90",tt="_back_1nhk9_97",st="_forward_1nhk9_101",nt="_disabled_1nhk9_110",ot="_progress_1nhk9_114",rt="_correctAnswers_1nhk9_123",at="_wrongAnswers_1nhk9_129",it="_noteContainer_1nhk9_147",ut="_hidden_1nhk9_87",ct="_note_1nhk9_147",lt={pageFadeOutDuration:Be,counter:Ne,question:Se,text:Fe,answers:Ge,option:je,fadeOut:He,button:Ke,correct:Ue,"correct-blinking":"_correct-blinking_1nhk9_64",success:We,wrong:Je,"wrong-fade":"_wrong-fade_1nhk9_71",next:Xe,answer:Ye,hiddenAnswer:Ze,navigation:et,back:tt,forward:st,disabled:nt,progress:ot,correctAnswers:rt,wrongAnswers:at,noteContainer:it,hidden:ut,note:ct},dt={$style:lt},pt=Ie(Ve,[["__cssModules",dt]]);export{pt as default};
