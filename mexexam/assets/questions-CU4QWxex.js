import{v as m,J as q,x as S,K as $,G as c}from"./index-DsShGSew.js";const I=m(()=>{const o=new Map,e=(n,i,p)=>{i&&p&&o.set(`$${n}$${i}`,p)},d=(n,i)=>i?o.get(`$${n}$${i}`)??i:"";return e("es","I don't know","No sé"),e("ru","I don't know","Не знаю"),{add:e,t:d}});var w=(o=>(o.Idle="idle",o.Loading="loading",o.Loaded="loaded",o.Error="error",o))(w||{});function y(o,e){return async()=>{o().loadingStatus="loading";try{await e(),o().loadingStatus="loaded"}catch{o().loadingStatus="error"}}}const M=m(()=>{const o=q(new Map),e=q(new Map),d=S(!1),n=I(),i=async()=>{if(e.size>0)return;const u=await $();for(const s of u){const l={id:s.id,title:s.title,questions:[],image:s.image,loadingStatus:w.Idle,load:y(()=>l,async()=>{var f;if(l.loadingStatus===w.Loaded)return;const h=await s.questions();for(const t of h){const r={id:t.id,section:l,answer:t.answer,question:t.question,note:t.note,noteImage:"noteImage"in t?t.noteImage:void 0,options:(f=t.options)==null?void 0:f.map((a,v)=>c({id:v,value:a,isAnswer:!1})),type:t.type==="text"?"text":"choice"};if(t.ru&&(n.add("ru",t.answer,t.ru.answer),n.add("ru",t.question,t.ru.question),n.add("ru",t.note,t.ru.note),t.ru.options&&t.options))for(let a=0;a<t.ru.options.length;a++)n.add("ru",t.options[a],t.ru.options[a]);if(t.en&&(n.add("en",t.answer,t.en.answer),n.add("en",t.question,t.en.question),n.add("en",t.note,t.en.note),t.en.options&&t.options))for(let a=0;a<t.en.options.length;a++)n.add("en",t.options[a],t.en.options[a]);r.type==="choice"&&r.options&&r.options.push(c({id:r.options.length,isAnswer:!0,value:r.answer}));const g=c(r);o.set(r.id,g),l.questions.push(g)}})};e.set(l.id,c(l)),n.add("ru",s.title,s.ru.title),n.add("en",s.title,s.en.title),d.value=!0}};return{loadAll:async()=>{await i(),await Promise.all([...e.values()].map(u=>u.load()))},loadSection:async u=>{await i();const s=e.get(u);s&&await s.load()},loadSections:i,reset:()=>{d.value=!1,o.clear()},isLoaded:d,questions:o,sections:e}});export{I as a,M as u};
