import{a as h,k as Q,q as oe,P as ae,Q as ie,S as le,v as re,y as O,p as ce,m as ue,x as d,E as s,u as t,D as _,H as i,F as y,I as de,L as D,M as G,N as se,O as te}from"./vendor-CXXHn2XU.js";import{u as ve,G as me,_ as _e}from"./localization-DiXc8Ugi.js";import{G as ne}from"./GeneralButton-XSvyp_hL.js";import{u as he}from"./questions-9F30Y7fw.js";import{c as fe}from"./utils-IZsLTAvW.js";import{R as pe}from"./index-9pF53O1f.js";const ge=10,$=ge*60*1e3,we=fe(()=>{const{questions:L,loadSections:V}=he(),v=h([]),r=h(new Map),c=h(new Map),A=h(!1),m=h(!1),p=h(null),C=h(null),g=h($),x=h(null),I=h(null),k=Q(()=>I.value===null?[...L.values()]:[...L.values()].filter(o=>o.section.id===I.value)),N=Q(()=>{const o=[];for(const e of k.value)e.type==="choice"&&o.push(e);return o}),R=(o=10)=>{const e=[...N.value],n=[];for(let l=0;l<Math.min(o,e.length);l++){const u=Math.floor(Math.random()*e.length);n.push(e[u]),e.splice(u,1)}return n},H=o=>{const e=[...o];for(let n=e.length-1;n>0;n--){const l=Math.floor(Math.random()*(n+1));[e[n],e[l]]=[e[l],e[n]]}return e},B=()=>{C.value=Date.now(),g.value=$,x.value=window.setInterval(()=>{if(C.value){const o=Date.now()-C.value;g.value=Math.max(0,$-o),g.value<=0&&(S(),z())}},1e3)},S=()=>{x.value&&(clearInterval(x.value),x.value=null)},P=o=>{const e=Math.ceil(o/1e3),n=Math.floor(e/60),l=e%60;return`${n.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`},U=async o=>{await V(),I.value=o??null,v.value=R(10),r.value.clear();for(const e of v.value)e.options&&r.value.set(e.id,H(e.options));c.value.clear(),A.value=!0,m.value=!1,p.value=null,B()},T=(o,e)=>{m.value||c.value.set(o,e)},b=o=>c.value.get(o)??null,z=()=>{var l;if(m.value)return;S();const o=[];let e=0,n=0;for(const u of v.value){const E=c.value.get(u.id),w=(l=u.options)==null?void 0:l.find(M=>M.id===E),a=(w==null?void 0:w.isAnswer)??!1;o.push({questionId:u.id,selectedOptionId:E??null,isCorrect:a}),a?e++:n++}p.value={correctAnswers:e,wrongAnswers:n,totalQuestions:v.value.length,percentage:Math.round(e/v.value.length*100),answers:o},m.value=!0},X=()=>{S(),v.value=[],r.value.clear(),c.value.clear(),A.value=!1,m.value=!1,p.value=null,C.value=null,g.value=$},j=o=>r.value.get(o.id)??[],W=o=>v.value.find(e=>e.id===o),J=o=>{var e;return(e=p.value)==null?void 0:e.answers.find(n=>n.questionId===o)},K=Q(()=>v.value.length>0&&c.value.size===v.value.length),F=Q(()=>c.value.size),q=Q(()=>P(g.value)),Y=Q(()=>g.value<=3e4);return{examQuestions:v,userAnswers:c,isExamStarted:A,isExamFinished:m,examResults:p,timeRemaining:g,formattedTimeRemaining:q,isTimeRunningOut:Y,startExam:U,selectAnswer:T,getSelectedAnswer:b,finishExam:z,resetExam:X,getRandomizedOptions:j,getQuestionById:W,getAnswerById:J,isAllQuestionsAnswered:K,answeredQuestionsCount:F,stopTimer:S}}),xe={class:"exam-header"},Ee=["title"],Ae={key:0,class:"loading"},Ce={key:1,class:"exam-content"},Se={class:"questions-list"},Qe=["data-question-id"],ke={class:"question-header"},Re={class:"question-number"},ye={class:"question-text"},Ie={class:"options-list"},Te=["name","value","checked","onChange","disabled"],be={class:"option-text"},Me={class:"finish-section"},Oe={key:2,class:"results-content"},Ne={class:"results-header"},Be={class:"results-summary"},Ue={class:"result-item correct"},ze={class:"result-label"},Fe={class:"result-value"},qe={class:"result-item wrong"},De={class:"result-label"},Ge={class:"result-value"},$e={class:"result-item total"},Le={class:"result-label"},Ve={class:"result-value"},He={class:"result-item percentage"},Pe={class:"result-label"},Xe={class:"result-value"},je={class:"results-questions"},We={class:"question-header"},Je={class:"question-number"},Ke={class:"question-text"},Ye={class:"options-list"},Ze={class:"option-text"},es={class:"actions"},ss=oe({__name:"ExamPage",setup(L){const V=ce(),v=ue(),{t:r}=ve(),{examQuestions:c,isExamStarted:A,isExamFinished:m,examResults:p,startExam:C,selectAnswer:g,getSelectedAnswer:x,finishExam:I,resetExam:k,getRandomizedOptions:N,getAnswerById:R,formattedTimeRemaining:H,isTimeRunningOut:B,isAllQuestionsAnswered:S,stopTimer:P}=we(),U=Q(()=>v.params.sectionId),T=h(new Map),b=h(!1);ae((e,n,l)=>{k(),l()}),ie(()=>{A.value&&k(),C(U.value).catch(console.error)}),le(()=>{P()});const z=(e,n)=>{g(e,n),b.value=!1},X=()=>{for(const e of c.value)if(x(e.id)===null)return e.id;return null},j=e=>{const n=T.value.get(e);n&&n.scrollIntoView({behavior:"smooth",block:"center"})},W=()=>{if(S.value)I(),window.scrollTo(0,0);else{b.value=!0;const e=X();e&&j(e)}},J=async()=>{k(),window.scrollTo(0,0),await C(U.value)},K=()=>{k(),V.push({name:pe.Home})},F=e=>{if(!m.value)return"";const n=R(e);return n?n.isCorrect?"correct":"wrong":""},q=(e,n)=>{var w;if(!m.value)return"";const l=R(e);if(!l)return"";const u=c.value.find(a=>a.id===e),E=(w=u==null?void 0:u.options)==null?void 0:w.find(a=>a.id===n);return E?E.isAnswer?"correct-answer":l.selectedOptionId===n&&!l.isCorrect?"wrong-answer":"":""},Y=(e,n)=>{n?T.value.set(e,n):T.value.delete(e)},o=e=>x(e)===null;return(e,n)=>(d(),re(me,null,{topBar:O(()=>[s("div",xe,[t(A)&&!t(m)?(d(),_("div",{key:0,class:y(["timer",{"time-running-out":t(B)}]),title:t(B)?t(r)("Time is running out!"):t(r)("Time remaining")},i(t(H)),11,Ee)):de("",!0)])]),default:O(()=>{var l,u,E,w;return[t(A)?t(m)?(d(),_("div",Oe,[s("div",Ne,[s("h2",null,i(t(r)("Exam Results")),1),s("div",Be,[s("div",Ue,[s("span",ze,i(t(r)("Correct")),1),s("span",Fe,i((l=t(p))==null?void 0:l.correctAnswers),1)]),s("div",qe,[s("span",De,i(t(r)("Wrong")),1),s("span",Ge,i((u=t(p))==null?void 0:u.wrongAnswers),1)]),s("div",$e,[s("span",Le,i(t(r)("Total")),1),s("span",Ve,i((E=t(p))==null?void 0:E.totalQuestions),1)]),s("div",He,[s("span",Pe,i(t(r)("Score")),1),s("span",Xe,i((w=t(p))==null?void 0:w.percentage)+"%",1)])])]),s("div",je,[(d(!0),_(D,null,G(t(c),(a,M)=>{var f,Z;return d(),_("div",{key:a.id,class:y(["result-question",F(a.id)])},[s("div",We,[s("span",Je,i(M+1)+".",1),s("span",Ke,i(a.question),1),s("span",{class:y(["result-indicator",(f=t(R)(a.id))!=null&&f.isCorrect?"correct":"wrong"])},i((Z=t(R)(a.id))!=null&&Z.isCorrect?"✓":"✗"),3)]),s("div",Ye,[(d(!0),_(D,null,G(t(N)(a),ee=>(d(),_("div",{key:ee.id,class:y(["option-item",q(a.id,ee.id)])},[s("span",Ze,i(ee.value),1)],2))),128))])],2)}),128))]),s("div",es,[se(ne,{onClick:J,class:"new-exam-button"},{default:O(()=>[te(i(t(r)("Start New Exam")),1)]),_:1}),se(ne,{onClick:K,class:"home-button"},{default:O(()=>[te(i(t(r)("Go Home")),1)]),_:1})])])):(d(),_("div",Ce,[s("div",Se,[(d(!0),_(D,null,G(t(c),(a,M)=>(d(),_("div",{key:a.id,"data-question-id":a.id,class:y(["question-item",F(a.id),{"unanswered-highlight":b.value&&o(a.id)}]),ref_for:!0,ref:f=>Y(a.id,f)},[s("div",ke,[s("span",Re,i(M+1)+".",1),s("span",ye,i(a.question),1)]),s("div",Ie,[(d(!0),_(D,null,G(t(N)(a),f=>(d(),_("label",{key:f.id,class:y(["option-item",q(a.id,f.id)])},[s("input",{type:"radio",name:`question-${a.id}`,value:f.id,checked:t(x)(a.id)===f.id,onChange:Z=>z(a.id,f.id),disabled:t(m)},null,40,Te),s("span",be,i(f.value),1)],2))),128))])],10,Qe))),128))]),s("div",Me,[se(ne,{onClick:W,class:"finish-button"},{default:O(()=>[te(i(t(S)?t(r)("Finish Exam"):t(r)("Check Unanswered Questions")),1)]),_:1})])])):(d(),_("div",Ae,i(t(r)("Loading exam...")),1))]}),_:1}))}}),rs=_e(ss,[["__scopeId","data-v-3ceb68a9"]]);export{rs as default};
