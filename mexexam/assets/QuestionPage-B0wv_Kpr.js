const __vite__fileDeps=["assets/interfaces-DBxtaz7F.js","assets/GeneralPage-vwk9yhS-.js","assets/index-Bb1SIHCd.js","assets/index-CZhs4V27.css","assets/GeneralPage-DidLOIUY.css","assets/interfaces-CnjOi9ha.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{_ as f,h as _e,r as y,q as z,s as G,v as H,x as ve,y as pe,a as te,z as we,A as W,B as se,C as me,d as fe,c as ge,w as S,n as w,g as s,D as he,o as h,b as k,m as T,e as V,k as J,j as b,l as I,t as N,F as X,E as Y,f as ke,G as be}from"./index-Bb1SIHCd.js";import{G as ye,m as Ae,S as Z,b as qe,_ as Oe}from"./GeneralPage-vwk9yhS-.js";import{G as Ce}from"./interfaces-DBxtaz7F.js";const B=Object.assign({"./questions/art-lit-music.ts":()=>f(()=>import("./art-lit-music-Bhrz2tO1.js"),[]),"./questions/art-paint-cinema.ts":()=>f(()=>import("./art-paint-cinema-YNWUfZIr.js"),[]),"./questions/citizenship.ts":()=>f(()=>import("./citizenship-C8WajnTK.js"),[]),"./questions/gastronomy.ts":()=>f(()=>import("./gastronomy-XnkjYgvu.js"),[]),"./questions/geografy.ts":()=>f(()=>import("./geografy-Djk_r5Cr.js"),[]),"./questions/history-colony.ts":()=>f(()=>import("./history-colony-CEsKSQc0.js"),[]),"./questions/history-independency.ts":()=>f(()=>import("./history-independency-BRIqbiq0.js"),[]),"./questions/history-modern.ts":()=>f(()=>import("./history-modern-C7q8OpuJ.js"),[]),"./questions/history-prespain.ts":()=>f(()=>import("./history-prespain-CDlcUevk.js"),[]),"./questions/history-revoluction.ts":()=>f(()=>import("./history-revoluction-DnDAoPUh.js"),[]),"./questions/interfaces.ts":()=>f(()=>import("./interfaces-DBxtaz7F.js").then(n=>n.i),__vite__mapDeps([0,1,2,3,4,5])),"./questions/science.ts":()=>f(()=>import("./science-Dk57vpCz.js"),[]),"./questions/traditions-culture.ts":()=>f(()=>import("./traditions-culture-C6eoM_xj.js"),[])}),je=async()=>{const n={sections:[]};await Promise.all(Object.values(B).map(e=>e()));for(const e in B){const u=await B[e]();u&&typeof u=="object"&&"data"in u&&n.sections.push(u.data)}return console.dir(n),n},Ee=_e(()=>{const{questions:n,translations:e,load:u}=Ie(),c=ee("correct-questions"),o=ee("wrong-questions"),l=y(),m=z({id:-1,value:"No se",isAnswer:!1});e.add("ru","No se","Не знаю");const r=()=>{let i=l.value;for(;i===l.value;)if(i=Pe(n,c.value,o.value),!i)return i;return i},t=G(()=>{if(!l.value)return null;const i=n.get(l.value);if(!i)throw new Error(`Failed to get question by id ${l.value}`);return i}),v=y([]),A=()=>{var i;v.value=[...(((i=t.value)==null?void 0:i.options)??[]).sort(()=>Math.random()-.5),m]},d=y(),p=y(!1),g=i=>{l.value=i},Q=i=>n.has(i),C=y(0),j=y(0),q=()=>{C.value=0,j.value=0},E=i=>{if(t.value&&t.value.type==="choice"){if(!v.value.includes(i))throw new Error("Current question does not have the selected option");d.value=i}},P=()=>{d.value&&t.value&&(d.value.isAnswer?(C.value++,c.value.add(t.value.id),o.value.delete(t.value.id)):(j.value++,o.value.add(t.value.id),c.value.delete(t.value.id)))},D=()=>{t.value&&t.value.type==="text"&&(p.value=!0)};H(()=>{var i;return(i=t.value)==null?void 0:i.id},()=>{d.value=void 0,p.value=!1,A()},{immediate:!0,flush:"sync"});const x=G(()=>({correctQuestions:c.value.size,wrongQuestions:o.value.size,unansweredQuestions:n.size-c.value.size-o.value.size,totalQuestions:n.size,correctPercentage:c.value.size/n.size*100,wrongPercentage:o.value.size/n.size*100,unansweredPercentage:(n.size-c.value.size-o.value.size)/n.size*100}));return{load:u,stat:x,correctCount:C,correctQuestions:c,wrongQuestions:o,currentOptionsRandomized:v,currentQuestion:t,isAnswerRevealed:p,selectedAnswer:d,translations:e,wrongCount:j,getRandomQuestionId:r,resetCount:q,updateCounters:P,revealAnswer:D,selectAnswer:E,setQuestion:g,hasQuestion:Q}});function ee(n){return ve(n,()=>new Set,void 0,{serializer:{read(e){return e?new Set(e.split(",")):new Set},write(e){return[...e].join(",")}}})}function Pe(n,e,u){if(Math.random()<u.size/10){const o=[...u];return o[Math.floor(Math.random()*o.length)]}if(Math.random()<.2){const o=[...e];return o[Math.floor(Math.random()*o.length)]}const c=[...n.keys()];return c[Math.floor(Math.random()*c.length)]}function Ie(){const n=new Map,e=new Map,u=Te();return{load:async()=>{var l;const o=await je();for(const m of o.sections){const r={id:m.id,title:m.title,questions:[],image:m.image};e.set(r.id,z(r)),u.add("ru",m.title,m.ru.title);for(const t of m.questions){const v={id:t.id,section:r,answer:t.answer,question:t.question,note:t.note,noteImage:"noteImage"in t?t.noteImage:void 0,options:(l=t.options)==null?void 0:l.map((d,p)=>z({id:p,value:d,isAnswer:!1})),type:t.type==="text"?"text":"choice"};if(u.add("ru",t.answer,t.ru.answer),u.add("ru",t.question,t.ru.question),u.add("ru",t.note,t.ru.note),t.ru.options&&t.options)for(let d=0;d<t.ru.options.length;d++)u.add("ru",t.options[d],t.ru.options[d]);v.type==="choice"&&v.options&&v.options.push(z({id:v.options.length,isAnswer:!0,value:v.answer}));const A=z(v);n.set(v.id,A),r.questions.push(A)}}},sections:e,questions:n,translations:u}}const Te=()=>{const n=new Map;return{add:(c,o,l)=>{o&&l&&n.set(`$${c}$${o}`,l)},t:(c,o)=>o?n.get(`$${c}$${o}`)??o:""}},F=new WeakMap;function Qe(n,e,u={}){const{mode:c="replace",route:o=pe(),router:l=te(),transform:m=d=>d}=u;F.has(l)||F.set(l,new Map);const r=F.get(l);let t=o.params[n];me(()=>{t=void 0});let v;const A=we((d,p)=>(v=p,{get(){return d(),m(t!==void 0&&t!==""?t:W(e))},set(g){t!==g&&(t=g===e||g===null?void 0:g,r.set(n,g===e||g===null?void 0:g),p(),se(()=>{if(r.size===0)return;const Q=Object.fromEntries(r.entries());r.clear();const{params:C,query:j,hash:q}=o;l[W(c)]({params:{...C,...Q},query:j,hash:q})}))}}));return H(()=>o.params[n],d=>{t=d,v()},{flush:"sync"}),A}const Re=["src"],ze=["src"],De=["innerHTML"],xe=fe({__name:"QuestionPage",setup(n){const e=he(),u=te(),{load:c,stat:o,isAnswerRevealed:l,currentOptionsRandomized:m,currentQuestion:r,getRandomQuestionId:t,revealAnswer:v,selectAnswer:A,updateCounters:d,selectedAnswer:p,setQuestion:g,hasQuestion:Q,translations:C}=Ee(),j=G(()=>{var a;return((a=r.value)==null?void 0:a.note)!==void 0}),q=Qe("id",""),E=y(),P=y(!1),D=()=>{q.value!==""&&(E.value=void 0,P.value=!1,Q(q.value)?g(q.value):u.replace({params:{id:t()}}))};H(q,D),c().then(D);let x;const i=y(!1);let R;const ne=()=>{E.value=void 0,window.clearTimeout(x),R=void 0,window.clearTimeout(R),i.value=!0,R=window.setTimeout(async()=>{R=void 0,await u.replace({params:{id:t()}}),await be(p).toBeUndefined(),await se(),i.value=!1},parseInt(e.pageFadeOutDuration,10))},L=()=>{var a,_;if(!R&&!(((a=r.value)==null?void 0:a.type)==="choice"&&!p.value)){if(((_=r.value)==null?void 0:_.type)==="text"&&!l.value){v();return}ne()}},oe=a=>{const _=[];return a.id===-1&&_.push(e.dontKnowOption),p.value?p.value.isAnswer?a===p.value?e.correct:(_.push(e["wrong-fade"]),_):a===E.value?(_.push(e["correct-blinking"]),_):a.isAnswer?(_.push(e.correct),_):(_.push(e.wrong),_):_},re=a=>{if(p.value){L();return}if(A(a),d(),!a.isAnswer){const _=m.value.find(O=>O.isAnswer);E.value=_}x=window.setTimeout(()=>{E.value=void 0},1e3)},M=y("es"),ae=a=>{K(a)||L()},ie=()=>{var a;(a=window.getSelection())!=null&&a.isCollapsed&&(M.value==="es"?M.value="ru":M.value="es")},$=a=>C.t(M.value,a),ue=a=>{K(a)||(a.stopPropagation(),ce())},ce=()=>{P.value=!1},le=()=>{P.value=!0},de=()=>{u.push({name:"settings"})};function K(a){const _=a.target;return _.tagName==="BUTTON"||_.tagName==="A"}return(a,_)=>(h(),ge(ye,{onClick:ae,class:w({[s(e).fadeOut]:i.value})},{topBar:S(()=>[k("div",{class:w(s(e).navigation)},[k("div",{class:w([{[s(e).disabled]:!j.value}]),onClick:T(le,["stop"])},[V(Z,{type:"mdi",path:s(Ae)},null,8,["path"])],2),k("div",{onClick:T(de,["stop"])},[V(Z,{type:"mdi",path:s(qe)},null,8,["path"])])],2)]),default:S(()=>[k("div",{class:w(s(e).progress)},[k("div",{class:w(s(e).correctAnswers),style:J({width:`${s(o).correctPercentage}%`})},null,6),k("div",{class:w(s(e).wrongAnswers),style:J({width:`${s(o).wrongPercentage}%`})},null,6)],2),s(r)?(h(),b("div",{key:0,class:w(s(e).question)},[k("div",{class:w(s(e).text),onClick:T(ie,["stop"])},[k("div",null,[s(r).section.image?(h(),b("img",{key:0,src:`/sections/${s(r).section.image}`},null,8,Re)):I("",!0),k("div",null,N($(s(r).question)),1)])],2),k("div",{class:w(s(e).answers)},[s(r).type==="choice"?(h(!0),b(X,{key:0},Y(s(m),O=>(h(),b("div",{key:`${s(r).id}-${O.id}`,class:w(s(e).option)},[V(Ce,{onClick:T(U=>re(O),["stop"]),class:w([s(e).button,oe(O)])},{default:S(()=>[ke(N($(O.value)),1)]),_:2},1032,["onClick","class"])],2))),128)):I("",!0),s(r).type==="text"?(h(),b("div",{key:1,class:w([s(e).answer,s(l)?"":s(e).hiddenAnswer]),onClick:T(L,["stop"])},[(h(!0),b(X,null,Y($(s(r).answer).split(`
`),(O,U)=>(h(),b("p",{key:U},N(O),1))),128))],2)):I("",!0)],2)],2)):I("",!0),s(r)?(h(),b("div",{key:1,onClick:T(ue,["stop"]),class:w([s(e).noteContainer,{[s(e).hidden]:!P.value}])},[s(r).note?(h(),b("div",{key:0,class:w(["scroll",[s(e).note,{[s(e).hidden]:!P.value}]])},[s(r).noteImage?(h(),b("img",{key:0,src:`/notes/${s(r).noteImage}`},null,8,ze)):I("",!0),k("div",{innerHTML:$(s(r).note)},null,8,De)],2)):I("",!0)],2)):I("",!0)]),_:1},8,["class"]))}}),Me="200ms",$e="_counter_1lkbj_4",Le="_question_1lkbj_8",Se="_text_1lkbj_15",Ve="_answers_1lkbj_46",Ne="_option_1lkbj_56",Be="_fadeOut_1lkbj_60",Fe="_button_1lkbj_66",Ge="_correct_1lkbj_66",He="_success_1lkbj_1",Ke="_wrong_1lkbj_73",Ue="_next_1lkbj_80",We="_answer_1lkbj_46",Je="_hiddenAnswer_1lkbj_93",Xe="_navigation_1lkbj_96",Ye="_back_1lkbj_103",Ze="_forward_1lkbj_107",et="_disabled_1lkbj_116",tt="_progress_1lkbj_120",st="_correctAnswers_1lkbj_129",nt="_wrongAnswers_1lkbj_135",ot="_noteContainer_1lkbj_153",rt="_hidden_1lkbj_93",at="_note_1lkbj_153",it={pageFadeOutDuration:Me,counter:$e,question:Le,text:Se,answers:Ve,option:Ne,fadeOut:Be,button:Fe,correct:Ge,"correct-blinking":"_correct-blinking_1lkbj_70",success:He,wrong:Ke,"wrong-fade":"_wrong-fade_1lkbj_77",next:Ue,answer:We,hiddenAnswer:Je,navigation:Xe,back:Ye,forward:Ze,disabled:et,progress:tt,correctAnswers:st,wrongAnswers:nt,noteContainer:ot,hidden:rt,note:at},ut={$style:it},_t=Oe(xe,[["__cssModules",ut]]);export{_t as default};
