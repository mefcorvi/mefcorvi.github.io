import{v as oe,x as h,m as b,d as ae,y as le,z as ie,A as re,i as ce,j as M,q as ue,p as de,o as m,a as s,b as t,c as v,t as l,n as R,f as me,F as G,r as $,k as ee,s as se,R as ve}from"./index-YTe8RbAl.js";import{u as _e,G as he,_ as fe}from"./localization-BUeGsQIP.js";import{G as te}from"./GeneralButton-DNyGmif0.js";import{u as pe}from"./questions-DtB0ryXF.js";const ge=10,q=ge*60*1e3,we=oe(()=>{const{questions:ne,loadAll:D,loadSection:V,reset:c}=pe(),r=h([]),x=h(new Map),u=h(new Map),A=h(!1),f=h(!1),S=h(null),C=h(null),p=h(q),g=h(null),O=b(()=>{const o=[];for(const e of ne.values())e.type==="choice"&&o.push(e);return o}),Q=(o=10)=>{const e=[...O.value],n=[];for(let i=0;i<Math.min(o,e.length);i++){const d=Math.floor(Math.random()*e.length);n.push(e[d]),e.splice(d,1)}return n},L=o=>{const e=[...o];for(let n=e.length-1;n>0;n--){const i=Math.floor(Math.random()*(n+1));[e[n],e[i]]=[e[i],e[n]]}return e},B=()=>{C.value=Date.now(),p.value=q,g.value=window.setInterval(()=>{if(C.value){const o=Date.now()-C.value;p.value=Math.max(0,q-o),p.value<=0&&(k(),U())}},1e3)},k=()=>{g.value&&(clearInterval(g.value),g.value=null)},H=o=>{const e=Math.ceil(o/1e3),n=Math.floor(e/60),i=e%60;return`${n.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`},N=async o=>{o?await V(o):await D(),r.value=Q(10),x.value.clear();for(const e of r.value)e.options&&x.value.set(e.id,L(e.options));u.value.clear(),A.value=!0,f.value=!1,S.value=null,B()},y=(o,e)=>{f.value||u.value.set(o,e)},T=o=>u.value.get(o)??null,U=()=>{var i;if(f.value)return;k();const o=[];let e=0,n=0;for(const d of r.value){const E=u.value.get(d.id),w=(i=d.options)==null?void 0:i.find(I=>I.id===E),a=(w==null?void 0:w.isAnswer)??!1;o.push({questionId:d.id,selectedOptionId:E??null,isCorrect:a}),a?e++:n++}S.value={correctAnswers:e,wrongAnswers:n,totalQuestions:r.value.length,percentage:Math.round(e/r.value.length*100),answers:o},f.value=!0},P=()=>{k(),r.value=[],x.value.clear(),u.value.clear(),A.value=!1,f.value=!1,S.value=null,C.value=null,p.value=q,c()},j=o=>x.value.get(o.id)??[],X=o=>r.value.find(e=>e.id===o),W=o=>{var e;return(e=S.value)==null?void 0:e.answers.find(n=>n.questionId===o)},J=b(()=>r.value.length>0&&u.value.size===r.value.length),z=b(()=>u.value.size),F=b(()=>H(p.value)),K=b(()=>p.value<=3e4);return{examQuestions:r,userAnswers:u,isExamStarted:A,isExamFinished:f,examResults:S,timeRemaining:p,formattedTimeRemaining:F,isTimeRunningOut:K,startExam:N,selectAnswer:y,getSelectedAnswer:T,finishExam:U,resetExam:P,getRandomizedOptions:j,getQuestionById:X,getAnswerById:W,isAllQuestionsAnswered:J,answeredQuestionsCount:z,stopTimer:k}}),xe={class:"exam-header"},Ae=["title"],Ce={key:0,class:"loading"},Ee={key:1,class:"exam-content"},Se={class:"questions-list"},ke={class:"question-header"},Qe={class:"question-number"},Re={class:"question-text"},be={class:"options-list"},ye=["name","value","checked","onChange","disabled"],Te={class:"option-text"},Ie={class:"finish-section"},Me={key:2,class:"results-content"},Oe={class:"results-header"},Be={class:"results-summary"},Ne={class:"result-item correct"},Ue={class:"result-label"},ze={class:"result-value"},Fe={class:"result-item wrong"},Ge={class:"result-label"},$e={class:"result-value"},qe={class:"result-item total"},De={class:"result-label"},Ve={class:"result-value"},Le={class:"result-item percentage"},He={class:"result-label"},Pe={class:"result-value"},je={class:"results-questions"},Xe={class:"question-header"},We={class:"question-number"},Je={class:"question-text"},Ke={class:"options-list"},Ye={class:"option-text"},Ze={class:"actions"},es=ae({__name:"ExamPage",setup(ne){const D=ue(),V=de(),{t:c}=_e(),{examQuestions:r,isExamStarted:x,isExamFinished:u,examResults:A,startExam:f,selectAnswer:S,getSelectedAnswer:C,finishExam:p,resetExam:g,getRandomizedOptions:O,getAnswerById:Q,formattedTimeRemaining:L,isTimeRunningOut:B,isAllQuestionsAnswered:k,stopTimer:H}=we(),N=b(()=>V.params.sectionId),y=h(new Map),T=h(!1);le((e,n,i)=>{g(),i()}),ie(()=>{x.value&&g(),f(N.value).catch(console.error)}),re(()=>{H()});const U=(e,n)=>{S(e,n),T.value=!1},P=()=>{for(const e of r.value)if(C(e.id)===null)return e.id;return null},j=e=>{const n=y.value.get(e);n&&n.scrollIntoView({behavior:"smooth",block:"center"})},X=()=>{if(k.value)p(),window.scrollTo(0,0);else{T.value=!0;const e=P();e&&j(e)}},W=async()=>{g(),window.scrollTo(0,0),await f(N.value)},J=()=>{g(),D.push({name:ve.Home})},z=e=>{if(!u.value)return"";const n=Q(e);return n?n.isCorrect?"correct":"wrong":""},F=(e,n)=>{var w;if(!u.value)return"";const i=Q(e);if(!i)return"";const d=r.value.find(a=>a.id===e),E=(w=d==null?void 0:d.options)==null?void 0:w.find(a=>a.id===n);return E?E.isAnswer?"correct-answer":i.selectedOptionId===n&&!i.isCorrect?"wrong-answer":"":""},K=(e,n)=>{n?y.value.set(e,n):y.value.delete(e)},o=e=>C(e)===null;return(e,n)=>(m(),ce(he,null,{topBar:M(()=>[s("div",xe,[t(x)&&!t(u)?(m(),v("div",{key:0,class:R(["timer",{"time-running-out":t(B)}]),title:t(B)?t(c)("Time is running out!"):t(c)("Time remaining")},l(t(L)),11,Ae)):me("",!0)])]),default:M(()=>{var i,d,E,w;return[t(x)?t(u)?(m(),v("div",Me,[s("div",Oe,[s("h2",null,l(t(c)("Exam Results")),1),s("div",Be,[s("div",Ne,[s("span",Ue,l(t(c)("Correct")),1),s("span",ze,l((i=t(A))==null?void 0:i.correctAnswers),1)]),s("div",Fe,[s("span",Ge,l(t(c)("Wrong")),1),s("span",$e,l((d=t(A))==null?void 0:d.wrongAnswers),1)]),s("div",qe,[s("span",De,l(t(c)("Total")),1),s("span",Ve,l((E=t(A))==null?void 0:E.totalQuestions),1)]),s("div",Le,[s("span",He,l(t(c)("Score")),1),s("span",Pe,l((w=t(A))==null?void 0:w.percentage)+"%",1)])])]),s("div",je,[(m(!0),v(G,null,$(t(r),(a,I)=>{var _,Y;return m(),v("div",{key:a.id,class:R(["result-question",z(a.id)])},[s("div",Xe,[s("span",We,l(I+1)+".",1),s("span",Je,l(a.question),1),s("span",{class:R(["result-indicator",(_=t(Q)(a.id))!=null&&_.isCorrect?"correct":"wrong"])},l((Y=t(Q)(a.id))!=null&&Y.isCorrect?"✓":"✗"),3)]),s("div",Ke,[(m(!0),v(G,null,$(t(O)(a),Z=>(m(),v("div",{key:Z.id,class:R(["option-item",F(a.id,Z.id)])},[s("span",Ye,l(Z.value),1)],2))),128))])],2)}),128))]),s("div",Ze,[ee(te,{onClick:W,class:"new-exam-button"},{default:M(()=>[se(l(t(c)("Start New Exam")),1)]),_:1}),ee(te,{onClick:J,class:"home-button"},{default:M(()=>[se(l(t(c)("Go Home")),1)]),_:1})])])):(m(),v("div",Ee,[s("div",Se,[(m(!0),v(G,null,$(t(r),(a,I)=>(m(),v("div",{key:a.id,class:R(["question-item",z(a.id),{"unanswered-highlight":T.value&&o(a.id)}]),ref_for:!0,ref:_=>K(a.id,_)},[s("div",ke,[s("span",Qe,l(I+1)+".",1),s("span",Re,l(a.question),1)]),s("div",be,[(m(!0),v(G,null,$(t(O)(a),_=>(m(),v("label",{key:_.id,class:R(["option-item",F(a.id,_.id)])},[s("input",{type:"radio",name:`question-${a.id}`,value:_.id,checked:t(C)(a.id)===_.id,onChange:Y=>U(a.id,_.id),disabled:t(u)},null,40,ye),s("span",Te,l(_.value),1)],2))),128))])],2))),128))]),s("div",Ie,[ee(te,{onClick:X,class:"finish-button"},{default:M(()=>[se(l(t(k)?t(c)("Finish Exam"):t(c)("Check Unanswered Questions")),1)]),_:1})])])):(m(),v("div",Ce,l(t(c)("Loading exam...")),1))]}),_:1}))}}),as=fe(es,[["__scopeId","data-v-afa5bccb"]]);export{as as default};
