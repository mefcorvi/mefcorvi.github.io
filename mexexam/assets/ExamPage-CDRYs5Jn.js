import{v as ee,x as g,m as b,d as se,y as te,i as ne,j as I,q as ae,p as oe,o as c,a as n,b as o,c as v,t as a,n as R,f as le,F as $,r as q,k as X,s as W,R as ie}from"./index-CP5BZ9_P.js";import{u as re,G as ce,_ as ue}from"./localization-n12GCzoU.js";import{G as J}from"./GeneralButton-ydkAZCh0.js";import{u as de,a as me}from"./questions-DTLdwwRe.js";const ve=10,D=ve*60*1e3,_e=ee(()=>{const{questions:K,loadAll:V,loadSection:H}=de(),u=g([]),S=g(new Map),d=g(new Map),E=g(!1),m=g(!1),h=g(null),A=g(null),p=g(D),y=g(null),L=b(()=>{const t=[];for(const e of K.values())e.type==="choice"&&t.push(e);return t}),Q=(t=10)=>{const e=[...L.value],s=[];for(let i=0;i<Math.min(t,e.length);i++){const l=Math.floor(Math.random()*e.length);s.push(e[l]),e.splice(l,1)}return s},O=t=>{const e=[...t];for(let s=e.length-1;s>0;s--){const i=Math.floor(Math.random()*(s+1));[e[s],e[i]]=[e[i],e[s]]}return e},T=()=>{A.value=Date.now(),p.value=D,y.value=window.setInterval(()=>{if(A.value){const t=Date.now()-A.value;p.value=Math.max(0,D-t),p.value<=0&&(M(),z())}},1e3)},M=()=>{y.value&&(clearInterval(y.value),y.value=null)},N=t=>{const e=Math.ceil(t/1e3),s=Math.floor(e/60),i=e%60;return`${s.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`},B=async t=>{t?await H(t):await V(),u.value=Q(10),S.value.clear();for(const e of u.value)e.options&&S.value.set(e.id,O(e.options));d.value.clear(),E.value=!0,m.value=!1,h.value=null,T()},P=(t,e)=>{m.value||d.value.set(t,e)},U=t=>d.value.get(t)??null,z=()=>{var i;if(m.value)return;M();const t=[];let e=0,s=0;for(const l of u.value){const k=d.value.get(l.id),C=(i=l.options)==null?void 0:i.find(Z=>Z.id===k),Y=(C==null?void 0:C.isAnswer)??!1;t.push({questionId:l.id,selectedOptionId:k??null,isCorrect:Y}),Y?e++:s++}h.value={correctAnswers:e,wrongAnswers:s,totalQuestions:u.value.length,percentage:Math.round(e/u.value.length*100),answers:t},m.value=!0},j=()=>{M(),u.value=[],S.value.clear(),d.value.clear(),E.value=!1,m.value=!1,h.value=null,A.value=null,p.value=D},r=t=>S.value.get(t.id)??[],F=t=>u.value.find(e=>e.id===t),G=t=>{var e;return(e=h.value)==null?void 0:e.answers.find(s=>s.questionId===t)},_=b(()=>u.value.length>0&&d.value.size===u.value.length),f=b(()=>d.value.size),w=b(()=>N(p.value)),x=b(()=>p.value<=3e4);return{examQuestions:u,userAnswers:d,isExamStarted:E,isExamFinished:m,examResults:h,timeRemaining:p,formattedTimeRemaining:w,isTimeRunningOut:x,startExam:B,selectAnswer:P,getSelectedAnswer:U,finishExam:z,resetExam:j,getRandomizedOptions:r,getQuestionById:F,getAnswerById:G,isAllQuestionsAnswered:_,answeredQuestionsCount:f}}),he={class:"exam-header"},fe=["title"],pe={key:0,class:"loading"},ge={key:1,class:"exam-content"},we={class:"questions-list"},xe={class:"question-header"},Ee={class:"question-number"},Ae={class:"question-text"},Ce={class:"options-list"},Se=["name","value","checked","onChange","disabled"],ye={class:"option-text"},Te={class:"finish-section"},ke={key:2,class:"results-content"},Re={class:"results-header"},be={class:"results-summary"},Me={class:"result-item correct"},Ie={class:"result-label"},Qe={class:"result-value"},Oe={class:"result-item wrong"},Ne={class:"result-label"},Be={class:"result-value"},ze={class:"result-item total"},Fe={class:"result-label"},Ge={class:"result-value"},$e={class:"result-item percentage"},qe={class:"result-label"},De={class:"result-value"},Ve={class:"results-questions"},He={class:"question-header"},Le={class:"question-number"},Pe={class:"question-text"},Ue={class:"options-list"},je={class:"option-text"},Xe={class:"actions"},We=se({__name:"ExamPage",setup(K){const V=ae(),H=oe(),u=me(),{locale:S}=re(),{examQuestions:d,isExamStarted:E,isExamFinished:m,examResults:h,startExam:A,selectAnswer:p,getSelectedAnswer:y,finishExam:L,resetExam:Q,getRandomizedOptions:O,getAnswerById:T,formattedTimeRemaining:M,isTimeRunningOut:N}=_e(),B=b(()=>H.params.sectionId);te(async()=>{E.value||await A(B.value)});const P=(_,f)=>{p(_,f)},U=()=>{L(),window.scrollTo(0,0)},z=async()=>{Q(),window.scrollTo(0,0),await A(B.value)},j=()=>{Q(),V.push({name:ie.Home})},r=_=>u.t(S.value,_),F=_=>{if(!m.value)return"";const f=T(_);return f?f.isCorrect?"correct":"wrong":""},G=(_,f)=>{var e;if(!m.value)return"";const w=T(_);if(!w)return"";const x=d.value.find(s=>s.id===_),t=(e=x==null?void 0:x.options)==null?void 0:e.find(s=>s.id===f);return t?t.isAnswer?"correct-answer":w.selectedOptionId===f&&!w.isCorrect?"wrong-answer":"":""};return(_,f)=>(c(),ne(ce,null,{topBar:I(()=>[n("div",he,[o(E)&&!o(m)?(c(),v("div",{key:0,class:R(["timer",{"time-running-out":o(N)}]),title:o(N)?r("Time is running out!"):r("Time remaining")},a(o(M)),11,fe)):le("",!0)])]),default:I(()=>{var w,x,t,e;return[o(E)?o(m)?(c(),v("div",ke,[n("div",Re,[n("h2",null,a(r("Exam Results")),1),n("div",be,[n("div",Me,[n("span",Ie,a(r("Correct")),1),n("span",Qe,a((w=o(h))==null?void 0:w.correctAnswers),1)]),n("div",Oe,[n("span",Ne,a(r("Wrong")),1),n("span",Be,a((x=o(h))==null?void 0:x.wrongAnswers),1)]),n("div",ze,[n("span",Fe,a(r("Total")),1),n("span",Ge,a((t=o(h))==null?void 0:t.totalQuestions),1)]),n("div",$e,[n("span",qe,a(r("Score")),1),n("span",De,a((e=o(h))==null?void 0:e.percentage)+"%",1)])])]),n("div",Ve,[(c(!0),v($,null,q(o(d),(s,i)=>{var l,k;return c(),v("div",{key:s.id,class:R(["result-question",F(s.id)])},[n("div",He,[n("span",Le,a(i+1)+".",1),n("span",Pe,a(s.question),1),n("span",{class:R(["result-indicator",(l=o(T)(s.id))!=null&&l.isCorrect?"correct":"wrong"])},a((k=o(T)(s.id))!=null&&k.isCorrect?"✓":"✗"),3)]),n("div",Ue,[(c(!0),v($,null,q(o(O)(s),C=>(c(),v("div",{key:C.id,class:R(["option-item",G(s.id,C.id)])},[n("span",je,a(C.value),1)],2))),128))])],2)}),128))]),n("div",Xe,[X(J,{onClick:z,class:"new-exam-button"},{default:I(()=>[W(a(r("Start New Exam")),1)]),_:1}),X(J,{onClick:j,class:"home-button"},{default:I(()=>[W(a(r("Go Home")),1)]),_:1})])])):(c(),v("div",ge,[n("div",we,[(c(!0),v($,null,q(o(d),(s,i)=>(c(),v("div",{key:s.id,class:R(["question-item",F(s.id)])},[n("div",xe,[n("span",Ee,a(i+1)+".",1),n("span",Ae,a(s.question),1)]),n("div",Ce,[(c(!0),v($,null,q(o(O)(s),l=>(c(),v("label",{key:l.id,class:R(["option-item",G(s.id,l.id)])},[n("input",{type:"radio",name:`question-${s.id}`,value:l.id,checked:o(y)(s.id)===l.id,onChange:k=>P(s.id,l.id),disabled:o(m)},null,40,Se),n("span",ye,a(l.value),1)],2))),128))])],2))),128))]),n("div",Te,[X(J,{onClick:U,class:"finish-button"},{default:I(()=>[W(a(r("Finish Exam")),1)]),_:1})])])):(c(),v("div",pe,a(r("Loading exam...")),1))]}),_:1}))}}),es=ue(We,[["__scopeId","data-v-31459ebe"]]);export{es as default};
