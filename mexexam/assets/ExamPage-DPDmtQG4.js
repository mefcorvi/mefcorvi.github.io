import{a as p,k as E,q as oe,P as ae,Q as ie,S as re,v as le,y as O,p as ce,m as ue,x as _,E as n,u as o,D as f,F as r,J as T,G as de,H as q,I as D,L as se,M as te}from"./vendor-DgBf67BD.js";import{u as me,G as ve,_ as _e}from"./localization-DHyW5zA5.js";import{G as ne}from"./GeneralButton-DRfAohle.js";import{u as he}from"./questions-8a8W_e0B.js";import{u as fe}from"./statistics-B7WG5HBg.js";import{c as pe}from"./utils-DENQyvkc.js";import{R as ge}from"./index-B9TXfkIM.js";const we=10,$=we*60*1e3,xe=pe(()=>{const{questions:L,loadSections:V}=he(),{recordCorrectAnswer:H,recordWrongAnswer:d,recordSessionStart:Q}=fe(),m=p([]),g=p(new Map),v=p(new Map),k=p(!1),x=p(!1),w=p(null),R=p(null),h=p($),C=p(null),S=p(null),P=E(()=>S.value===null?[...L.values()]:[...L.values()].filter(s=>s.section.id===S.value)),B=E(()=>{const s=[];for(const e of P.value)e.type==="choice"&&s.push(e);return s}),N=(s=10)=>{const e=[...B.value],i=[];for(let c=0;c<Math.min(s,e.length);c++){const t=Math.floor(Math.random()*e.length);i.push(e[t]),e.splice(t,1)}return i},W=s=>{const e=[...s];for(let i=e.length-1;i>0;i--){const c=Math.floor(Math.random()*(i+1));[e[i],e[c]]=[e[c],e[i]]}return e},U=()=>{R.value=Date.now(),h.value=$,C.value=window.setInterval(()=>{if(R.value){const s=Date.now()-R.value;h.value=Math.max(0,$-s),h.value<=0&&(A(),z())}},1e3)},A=()=>{C.value&&(clearInterval(C.value),C.value=null)},M=s=>{const e=Math.ceil(s/1e3),i=Math.floor(e/60),c=e%60;return`${i.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`},X=async s=>{await V(),S.value=s??null,m.value=N(10),g.value.clear();for(const e of m.value)e.options&&g.value.set(e.id,W(e.options));v.value.clear(),k.value=!0,x.value=!1,w.value=null,U(),Q()},j=(s,e)=>{x.value||v.value.set(s,e)},J=s=>v.value.get(s)??null,z=()=>{var c;if(x.value)return;A();const s=[];let e=0,i=0;for(const t of m.value){const y=v.value.get(t.id),u=(c=t.options)==null?void 0:c.find(b=>b.id===y),I=(u==null?void 0:u.isAnswer)??!1;s.push({questionId:t.id,selectedOptionId:y??null,isCorrect:I}),I?(e++,H(t.id)):(i++,d(t.id))}w.value={correctAnswers:e,wrongAnswers:i,totalQuestions:m.value.length,percentage:Math.round(e/m.value.length*100),answers:s},x.value=!0},K=()=>{A(),m.value=[],g.value.clear(),v.value.clear(),k.value=!1,x.value=!1,w.value=null,R.value=null,h.value=$},Y=s=>g.value.get(s.id)??[],F=s=>m.value.find(e=>e.id===s),G=s=>{var e;return(e=w.value)==null?void 0:e.answers.find(i=>i.questionId===s)},Z=E(()=>m.value.length>0&&v.value.size===m.value.length),ee=E(()=>v.value.size),a=E(()=>M(h.value)),l=E(()=>h.value<=3e4);return{examQuestions:m,userAnswers:v,isExamStarted:k,isExamFinished:x,examResults:w,timeRemaining:h,formattedTimeRemaining:a,isTimeRunningOut:l,startExam:X,selectAnswer:j,getSelectedAnswer:J,finishExam:z,resetExam:K,getRandomizedOptions:Y,getQuestionById:F,getAnswerById:G,isAllQuestionsAnswered:Z,answeredQuestionsCount:ee,stopTimer:A}}),Se={class:"exam-header"},Ae=["title"],Ce={key:0,class:"loading"},Ee={key:1,class:"exam-content"},Qe={class:"questions-list"},ke=["data-question-id"],Re={class:"question-header"},ye={class:"question-number"},Ie={class:"question-text"},Te={class:"options-list"},Me=["name","value","checked","onChange","disabled"],be={class:"option-text"},Oe={class:"finish-section"},Be={key:2,class:"results-content"},Ne={class:"results-header"},Ue={class:"results-summary"},ze={class:"result-item correct"},Fe={class:"result-label"},Ge={class:"result-value"},qe={class:"result-item wrong"},De={class:"result-label"},$e={class:"result-value"},Le={class:"result-item total"},Ve={class:"result-label"},He={class:"result-value"},Pe={class:"result-item percentage"},We={class:"result-label"},Xe={class:"result-value"},je={class:"results-questions"},Je={class:"question-header"},Ke={class:"question-number"},Ye={class:"question-text"},Ze={class:"options-list"},es={class:"option-text"},ss={class:"actions"},ts=oe({__name:"ExamPage",setup(L){const V=ce(),H=ue(),{t:d}=me(),{examQuestions:Q,isExamStarted:m,isExamFinished:g,examResults:v,startExam:k,selectAnswer:x,getSelectedAnswer:w,finishExam:R,resetExam:h,getRandomizedOptions:C,getAnswerById:S,formattedTimeRemaining:P,isTimeRunningOut:B,isAllQuestionsAnswered:N,stopTimer:W}=xe(),U=E(()=>H.params.sectionId),A=p(new Map),M=p(!1);ae((a,l,s)=>{h(),s()}),ie(()=>{m.value&&h(),k(U.value).catch(console.error)}),re(()=>{W()});const X=(a,l)=>{x(a,l),M.value=!1},j=()=>{for(const a of Q.value)if(w(a.id)===null)return a.id;return null},J=a=>{const l=A.value.get(a);l&&l.scrollIntoView({behavior:"smooth",block:"center"})},z=()=>{if(N.value)R(),window.scrollTo(0,0);else{M.value=!0;const a=j();a&&J(a)}},K=async()=>{h(),window.scrollTo(0,0),await k(U.value)},Y=()=>{h(),V.push({name:ge.Home})},F=a=>{if(!g.value)return"";const l=S(a);return l?l.isCorrect?"correct":"wrong":""},G=(a,l)=>{var c;if(!g.value)return"";const s=S(a);if(!s)return"";const e=Q.value.find(t=>t.id===a),i=(c=e==null?void 0:e.options)==null?void 0:c.find(t=>t.id===l);return i?i.isAnswer?"correct-answer":s.selectedOptionId===l&&!s.isCorrect?"wrong-answer":"":""},Z=(a,l)=>{l?A.value.set(a,l):A.value.delete(a)},ee=a=>w(a)===null;return(a,l)=>(_(),le(ve,null,{topBar:O(()=>[n("div",Se,[o(m)&&!o(g)?(_(),f("div",{key:0,class:T(["timer",{"time-running-out":o(B)}]),title:o(B)?o(d)("Time is running out!"):o(d)("Time remaining")},r(o(P)),11,Ae)):de("",!0)])]),default:O(()=>{var s,e,i,c;return[o(m)?o(g)?(_(),f("div",Be,[n("div",Ne,[n("h2",null,r(o(d)("Exam Results")),1),n("div",Ue,[n("div",ze,[n("span",Fe,r(o(d)("Correct")),1),n("span",Ge,r((s=o(v))==null?void 0:s.correctAnswers),1)]),n("div",qe,[n("span",De,r(o(d)("Wrong")),1),n("span",$e,r((e=o(v))==null?void 0:e.wrongAnswers),1)]),n("div",Le,[n("span",Ve,r(o(d)("Total")),1),n("span",He,r((i=o(v))==null?void 0:i.totalQuestions),1)]),n("div",Pe,[n("span",We,r(o(d)("Score")),1),n("span",Xe,r((c=o(v))==null?void 0:c.percentage)+"%",1)])])]),n("div",je,[(_(!0),f(q,null,D(o(Q),(t,y)=>{var u,I;return _(),f("div",{key:t.id,class:T(["result-question",F(t.id)])},[n("div",Je,[n("span",Ke,r(y+1)+".",1),n("span",Ye,r(t.question),1),n("span",{class:T(["result-indicator",(u=o(S)(t.id))!=null&&u.isCorrect?"correct":"wrong"])},r((I=o(S)(t.id))!=null&&I.isCorrect?"✓":"✗"),3)]),n("div",Ze,[(_(!0),f(q,null,D(o(C)(t),b=>(_(),f("div",{key:b.id,class:T(["option-item",G(t.id,b.id)])},[n("span",es,r(b.value),1)],2))),128))])],2)}),128))]),n("div",ss,[se(ne,{onClick:K,class:"new-exam-button"},{default:O(()=>[te(r(o(d)("Start New Exam")),1)]),_:1}),se(ne,{onClick:Y,class:"home-button"},{default:O(()=>[te(r(o(d)("Go Home")),1)]),_:1})])])):(_(),f("div",Ee,[n("div",Qe,[(_(!0),f(q,null,D(o(Q),(t,y)=>(_(),f("div",{key:t.id,"data-question-id":t.id,class:T(["question-item",F(t.id),{"unanswered-highlight":M.value&&ee(t.id)}]),ref_for:!0,ref:u=>Z(t.id,u)},[n("div",Re,[n("span",ye,r(y+1)+".",1),n("span",Ie,r(t.question),1)]),n("div",Te,[(_(!0),f(q,null,D(o(C)(t),u=>(_(),f("label",{key:u.id,class:T(["option-item",G(t.id,u.id)])},[n("input",{type:"radio",name:`question-${t.id}`,value:u.id,checked:o(w)(t.id)===u.id,onChange:I=>X(t.id,u.id),disabled:o(g)},null,40,Me),n("span",be,r(u.value),1)],2))),128))])],10,ke))),128))]),n("div",Oe,[se(ne,{onClick:z,class:"finish-button"},{default:O(()=>[te(r(o(N)?o(d)("Finish Exam"):o(d)("Check Unanswered Questions")),1)]),_:1})])])):(_(),f("div",Ce,r(o(d)("Loading exam...")),1))]}),_:1}))}}),us=_e(ts,[["__scopeId","data-v-f1358415"]]);export{us as default};
